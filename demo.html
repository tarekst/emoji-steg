<!DOCTYPE html>
<html lang="en" class="h-full bg-gray-50">
<head>
    <meta charset="utf-8" />
    <title>emoji‑steg Demo</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
</head>
<body class="min-h-full flex flex-col items-center py-10">
<div class="w-full max-w-4xl px-4">
    <h1 class="text-3xl font-bold tracking-tight text-indigo-600 text-center mb-8">
        emoji‑steg <span class="text-gray-900">Browser Demo</span>
    </h1>

    <!-- Encode / Decode grid -->
    <div class="grid md:grid-cols-2 gap-6">
        <!-- Encode Card -->
        <section class="bg-white shadow-md rounded-2xl p-6 flex flex-col">
            <h2 class="text-xl font-semibold text-gray-800 mb-4 flex items-center gap-2">
                <span class="text-2xl">🔐</span> Hide a Secret Message
            </h2>
            <label class="text-sm font-medium text-gray-700 mb-1" for="plain">Message</label>
            <textarea id="plain" rows="4" class="resize-none rounded-xl border border-gray-300 focus:ring-indigo-500 focus:border-indigo-500 p-3 text-sm" placeholder="Type your secret text…"></textarea>

            <label class="text-sm font-medium text-gray-700 mt-4 mb-1" for="pwd">Password</label>
            <div class="flex gap-2 items-center">
                <input id="pwd" type="password" class="flex-grow rounded-xl border border-gray-300 focus:ring-indigo-500 focus:border-indigo-500 p-3 text-sm" placeholder="Password…" />
                <button id="togglePwd" class="shrink-0 rounded-xl bg-gray-100 px-3 py-2 hover:bg-gray-200" title="Show / hide password">👁️</button>
            </div>

            <label class="text-sm font-medium text-gray-700 mt-4 mb-1" for="emoji">Emoji (blank = random)</label>
            <div class="flex gap-2 items-center">
                <input id="emoji" class="flex-grow rounded-xl border border-gray-300 focus:ring-indigo-500 focus:border-indigo-500 p-3 text-sm text-center" />
                <button id="btnEmojiRandom" class="shrink-0 rounded-xl bg-gray-100 px-3 py-2 hover:bg-gray-200" title="Generate random emoji">🔄</button>
                <button id="btnEmojiPicker" class="shrink-0 rounded-xl bg-gray-100 px-3 py-2 hover:bg-gray-200" title="Open emoji picker">😊</button>
            </div>

            <button id="btnEncrypt" class="mt-6 inline-flex justify-center items-center gap-2 rounded-xl bg-indigo-600 px-4 py-2 text-white font-medium shadow hover:bg-indigo-700 transition-colors">Hide in Emoji</button>

            <label class="text-sm font-medium text-gray-700 mt-6 mb-1" for="cipher">Generated Emoji</label>
            <div class="flex gap-2 items-center">
                <input id="cipher" readonly class="flex-grow min-w-0 rounded-xl border border-gray-300 p-3 text-center text-2xl" />
                <button id="btnCopy" class="shrink-0 rounded-xl bg-gray-100 px-3 py-2 text-sm hover:bg-gray-200" title="Copy to clipboard">📋</button>
            </div>
        </section>

        <!-- Decode Card -->
        <section class="bg-white shadow-md rounded-2xl p-6 flex flex-col">
            <h2 class="text-xl font-semibold text-gray-800 mb-4 flex items-center gap-2">
                <span class="text-2xl">🔎</span> Reveal the Hidden Message
            </h2>
            <label class="text-sm font-medium text-gray-700 mb-1" for="cipherIn">Emoji with hidden text</label>
            <input id="cipherIn" class="rounded-xl border border-gray-300 focus:ring-indigo-500 focus:border-indigo-500 p-3 text-2xl text-center" placeholder="🔒" />

            <label class="text-sm font-medium text-gray-700 mt-4 mb-1" for="pwd2">Password</label>
            <div class="flex gap-2 items-center">
                <input id="pwd2" type="password" class="flex-grow rounded-xl border border-gray-300 focus:ring-indigo-500 focus:border-indigo-500 p-3 text-sm" placeholder="Password…" />
                <button id="togglePwd2" class="shrink-0 rounded-xl bg-gray-100 px-3 py-2 hover:bg-gray-200" title="Show / hide password">👁️</button>
            </div>

            <button id="btnDecrypt" class="mt-6 inline-flex justify-center items-center gap-2 rounded-xl bg-indigo-600 px-4 py-2 text-white font-medium shadow hover:bg-indigo-700 transition-colors">Decrypt</button>

            <div id="decoded" class="mt-4 text-center text-lg font-semibold text-gray-800 break-words"></div>
        </section>
    </div>
</div>

<!-- Emoji Picker Modal -->
<div id="emojiModal" class="fixed inset-0 z-50 hidden flex items-center justify-center bg-black/50">
    <div class="bg-white w-11/12 max-w-5xl rounded-2xl shadow-lg p-6 flex flex-col gap-4">
        <div class="flex justify-between items-center mb-2">
            <h3 class="text-lg font-semibold">Pick an emoji</h3>
            <button id="closeModal" class="text-xl leading-none hover:text-red-500">×</button>
        </div>
        <div>
            <div id="tabTriggers" class="flex flex-wrap gap-2 border-b mb-4 overflow-x-auto"></div>
            <div id="tabPanels" class="h-[32rem] overflow-y-auto pr-1"></div>
        </div>
    </div>
</div>

<!-- Library -->
<script>window.exports = {};</script>
<script src="https://cdn.jsdelivr.net/gh/tarekst/emoji-steg/src/emoji-steg.js"></script>
<script>
  (function(){
    const { encryptInEmoji:enc, decryptFromEmoji:dec } = window.exports;
    const $ = id => document.getElementById(id);

    const plain=$("plain"), pwd=$("pwd"), emojiInp=$("emoji"), cipherInp=$("cipher"), cipherIn=$("cipherIn"), pwd2=$("pwd2"), decoded=$("decoded");
    const togglePwd=$("togglePwd"), togglePwd2=$("togglePwd2"), btnRand=$("btnEmojiRandom"), btnPicker=$("btnEmojiPicker"), btnEncrypt=$("btnEncrypt"), btnCopy=$("btnCopy"), btnDecrypt=$("btnDecrypt");
    const modal=$("emojiModal"), closeBtn=$("closeModal"), tabTrig=$("tabTriggers"), tabPanels=$("tabPanels");

    const categories = {
      "Smileys & Emotions": [
        "😀", "😃", "😄", "😁", "😆", "😅", "🤣", "😂", "🙂", "🙃", "😉", "😊", "😇", "🥰", "😍", "🤩", "😘", "😗", "😚", "😙",
        "😋", "😛", "😜", "🤪", "😝", "🤑", "🤗", "🤭", "🤫", "🤔", "🤐", "🤨", "😐", "😑", "😶", "😏", "😒", "🙄", "😬", "🤥",
        "😌", "😔", "😪", "🤤", "😴", "😷", "🤒", "🤕", "🤢", "🤮", "🤧", "🥵", "🥶", "🥴", "😵", "🤯", "🤠", "🥳", "😎", "🤓",
        "🧐", "😕", "😟", "🙁", "☹️", "😮", "😯", "😲", "😳", "🥺", "😦", "😧", "😨", "😰", "😥", "😢", "😭", "😱", "😖", "😣",
        "😞", "😓", "😩", "😫", "🥱", "😤", "😡", "😠", "🤬", "😈", "👿", "💀", "☠️", "💩", "🤡", "👹", "👺", "👻", "👽", "👾",
        "🤖", "😺", "😸", "😹", "😻", "😼", "😽", "🙀", "😿", "😾"
      ],
      "Gestures & People": [
        "👋", "🤚", "🖐️", "✋", "🖖", "👌", "🤌", "🤏", "✌️", "🤞", "🤟", "🤘", "🤙", "👈", "👉", "👆", "🖕", "👇", "☝️", "👍",
        "👎", "✊", "👊", "🤛", "🤜", "👏", "🙌", "👐", "🤲", "🤝", "🙏", "✍️", "💅", "🤳", "💪", "🦾", "🦿", "🦵", "🦶", "👂",
        "🦻", "👃", "🧠", "🫀", "🫁", "🦷", "🦴", "👀", "👁️", "👅", "👄", "👶", "🧒", "👦", "👧", "🧑", "👱", "👨", "🧔", "👨‍🦰",
        "👨‍🦱", "👨‍🦳", "👨‍🦲", "👩", "👩‍🦰", "🧑‍🦰", "👩‍🦱", "🧑‍🦱", "👩‍🦳", "🧑‍🦳", "👩‍🦲", "🧑‍🦲", "👱‍♀️", "👱‍♂️", "🧓", "👴", "👵"
      ],
      "Animals": [
        "🐵", "🐒", "🦍", "🦧", "🐶", "🐕", "🦮", "🐕‍🦺", "🐩", "🐺", "🦊", "🦝", "🐱", "🐈", "🐈‍⬛", "🦁", "🐯", "🐅", "🐆", "🐴",
        "🐎", "🦄", "🦓", "🦌", "🦬", "🐮", "🐂", "🐃", "🐄", "🐷", "🐖", "🐗", "🐽", "🐏", "🐑", "🐐", "🐪", "🐫", "🦙", "🦒",
        "🐘", "🦣", "🦏", "🦛", "🐭", "🐁", "🐀", "🐹", "🐰", "🐇", "🐿️", "🦫", "🦔", "🦇", "🐻", "🐻‍❄️", "🐨", "🐼", "🦥", "🦦",
        "🦨", "🦘", "🦡", "🐾", "🦃", "🐔", "🐓", "🐣", "🐤", "🐥", "🐦", "🐧", "🕊️", "🦅", "🦆", "🦢", "🦉", "🦤", "🪶", "🦩",
        "🦚", "🦜", "🐸", "🐊", "🐢", "🦎", "🐍", "🐲", "🐉", "🦕", "🦖", "🐳", "🐋", "🐬", "🦭", "🐟", "🐠", "🐡", "🦈", "🐙",
        "🐚", "🐌", "🦋", "🐛", "🐜", "🐝", "🪲", "🐞", "🦗", "🪳", "🕷️", "🕸️", "🦂", "🦟", "🪰", "🪱"
      ],
      "Food & Drink": [
        "🍇", "🍈", "🍉", "🍊", "🍋", "🍌", "🍍", "🥭", "🍎", "🍏", "🍐", "🍑", "🍒", "🍓", "🫐", "🥝", "🍅", "🫒", "🥥", "🥑",
        "🍆", "🥔", "🥕", "🌽", "🌶️", "🫑", "🥒", "🥬", "🥦", "🧄", "🧅", "🍄", "🥜", "🌰", "🍞", "🥐", "🥖", "🫓", "🥨", "🥯",
        "🥞", "🧇", "🧀", "🍖", "🍗", "🥩", "🥓", "🍔", "🍟", "🍕", "🌭", "🥪", "🌮", "🌯", "🫔", "🥙", "🧆", "🥚", "🍳", "🥘",
        "🍲", "🫕", "🥣", "🥗", "🍿", "🧈", "🧂", "🥫", "🍱", "🍘", "🍙", "🍚", "🍛", "🍜", "🍝", "🍠", "🍢", "🍣", "🍤", "🍥",
        "🥮", "🍡", "🥟", "🥠", "🥡", "🦀", "🦞", "🦐", "🦑", "🦪", "🍦", "🍧", "🍨", "🍩", "🍪", "🎂", "🍰", "🧁", "🥧", "🍫",
        "🍬", "🍭", "🍮", "🍯", "🍼", "🥛", "☕", "🫖", "🍵", "🍶", "🍾", "🍷", "🍸", "🍹", "🍺", "🍻", "🥂", "🥃", "🥤", "🧋",
        "🧃", "🧉", "🧊"
      ],
      "Sports & Activities": [
        "⚽", "🏀", "🏈", "⚾", "🥎", "🎾", "🏐", "🏉", "🥏", "🎱", "🪀", "🏓", "🏸", "🏒", "🏑", "🥍", "🏏", "🪃", "🥅", "⛳",
        "🪁", "🏹", "🎣", "🤿", "🥊", "🥋", "🎽", "🛹", "🛼", "🛷", "⛸️", "🥌", "🎿", "⛷️", "🏂", "🪂", "🏋️", "🏋️‍♀️", "🏋️‍♂️", "🤼",
        "🤼‍♀️", "🤼‍♂️", "🤸", "🤸‍♀️", "🤸‍♂️", "⛹️", "⛹️‍♀️", "⛹️‍♂️", "🤺", "🤾", "🤾‍♀️", "🤾‍♂️", "🏌️", "🏌️‍♀️", "🏌️‍♂️", "🏇", "🧘", "🧘‍♀️", "🧘‍♂️", "🏄",
        "🏄‍♀️", "🏄‍♂️", "🏊", "🏊‍♀️", "🏊‍♂️", "🤽", "🤽‍♀️", "🤽‍♂️", "🚣", "🚣‍♀️", "🚣‍♂️", "🧗", "🧗‍♀️", "🧗‍♂️", "🚵", "🚵‍♀️", "🚵‍♂️", "🚴", "🚴‍♀️", "🚴‍♂️"
      ],
      "Travel & Places": [
        "🚀", "🛸", "🛰️", "🪐", "🌍", "🌎", "🌏", "🌑", "🌒", "🌓", "🌔", "🌕", "🌖", "🌗", "🌘", "🌙", "🌚", "🌛", "🌜", "☀️",
        "🌝", "🌞", "⭐", "🌟", "🌠", "🌌", "☁️", "⛅", "⛈️", "🌤️", "🌥️", "🌦️", "🌧️", "🌨️", "🌩️", "🌪️", "🌫️", "🌬️", "🌈", "☂️",
        "☔", "⚡", "❄️", "☃️", "⛄", "☄️", "🔥", "💧", "🌊", "🏙️", "🌆", "🌇", "🌃", "🌉", "🏠", "🏡", "🏗️", "🏢", "🏬", "🏣",
        "🏤", "🏥", "🏦", "🏨", "🏪", "🏫", "🏩", "💒", "🏛️", "⛪", "🕌", "🕍", "🛕", "🕋", "⛩️", "🛤️", "🛣️", "🗾", "🎑", "🏞️",
        "🌅", "🌄", "🌠", "🎇", "🎆", "🌇", "🏙️", "🌃", "🌌", "🌉", "🌁", "🛫", "🛬", "🛩️", "💺", "🚁", "🚟", "🚠", "🚡", "🚀",
        "🛸", "🚇", "🚄", "🚅", "🚈", "🚉", "🚂", "🚆", "🚊", "🚞", "🚝", "🚋", "🚌", "🚍", "🚎", "🚐", "🚑", "🚒", "🚓", "🚔",
        "🚕", "🚖", "🚗", "🚘", "🚙", "🚚", "🚛", "🚜", "🦯", "🦽", "🦼", "🛴", "🚲", "🛵", "🏍️", "🛺", "🚨", "🚥", "🚦", "🛑",
        "🚧", "⚓", "⛵", "🛶", "🚤", "🛳️", "⛴️", "🛥️", "🚢", "✈️", "🛫", "🛬", "🪂", "💺", "🚁", "🚟", "🚠", "🚡", "🚁", "🚀"
      ],
      "Objects & Symbols": [
        "⌚", "📱", "📲", "💻", "⌨️", "🖥️", "🖨️", "🖱️", "🖲️", "🕹️", "🗜️", "💽", "💾", "💿", "📀", "📼", "📷", "📸", "📹", "🎥",
        "📽️", "🎞️", "📞", "☎️", "📟", "📠", "📺", "📻", "🎙️", "🎚️", "🎛️", "🧭", "⏱️", "⏲️", "⏰", "🕰️", "⌛", "⏳", "📡", "🔋",
        "🔌", "💡", "🔦", "🕯️", "🪔", "🧯", "🛢️", "💸", "💵", "💴", "💶", "💷", "💰", "💳", "💎", "⚖️", "🪜", "🧰", "🪛", "🔧",
        "🔨", "⚒️", "🛠️", "🧲", "🔩", "⚙️", "🧱", "⛓️", "🧪", "🧫", "🧬", "🔬", "🔭", "📡", "💉", "🩸", "💊", "🩹", "🩺", "🚪",
        "🪑", "🚽", "🚿", "🛁", "🪤", "🪒", "🧴", "🧷", "🧹", "🧺", "🧻", "🪣", "🧼", "🪥", "🧽", "🧯", "🛒", "🚬", "⚰️", "🪦",
        "⚱️", "🗿", "🪧", "🏧", "🚮", "🚰", "♿", "🚹", "🚺", "🚻", "🚼", "🚾", "🛂", "🛃", "🛄", "🛅", "⚠️", "🚸", "⛔", "🚫",
        "🚳", "🚭", "🚯", "🚱", "🚷", "📵", "🔞", "☢️", "☣️", "⬆️", "↗️", "➡️", "↘️", "⬇️", "↙️", "⬅️", "↖️", "↕️", "↔️", "↩️",
        "↪️", "⤴️", "⤵️", "🔃", "🔄", "🔙", "🔚", "🔛", "🔜", "🔝", "🛐", "⚛️", "🕉️", "✡️", "☸️", "☯️", "✝️", "☦️", "☪️", "☮️",
        "🕎", "🔯", "♈", "♉", "♊", "♋", "♌", "♍", "♎", "♏", "♐", "♑", "♒", "♓", "⛎", "🔀", "🔁", "🔂", "▶️", "⏩", "⏭️", "⏯️",
        "◀️", "⏪", "⏮️", "🔼", "⏫", "🔽", "⏬", "⏸️", "⏹️", "⏺️", "⏏️", "🎦", "🔅", "🔆", "📶", "📳", "📴", "♀️", "♂️", "⚧️", "✖️",
        "➕", "➖", "➗", "♾️", "‼️", "⁉️", "❓", "❔", "❕", "❗", "〰️", "💱", "💲", "⚕️", "♻️", "⚜️", "🔱", "📛", "🔰", "⭕", "✅",
        "☑️", "✔️", "❌", "❎", "➰", "➿", "〽️", "✳️", "✴️", "❇️", "©️", "®️", "™️", "#️⃣", "*️⃣", "0️⃣", "1️⃣", "2️⃣", "3️⃣", "4️⃣",
        "5️⃣", "6️⃣", "7️⃣", "8️⃣", "9️⃣", "🔟", "🔠", "🔡", "🔢", "🔣", "🔤", "🅰️", "🆎", "🅱️", "🆑", "🆒", "🆓", "ℹ️", "🆔", "Ⓜ️",
        "🆕", "🆖", "🅾️", "🆗", "🅿️", "🆘", "🆙", "🆚", "🈁", "🈂️", "🈷️", "🈶", "🈯", "🉐", "🈹", "🈚", "🈲", "🉑", "🈸", "🈴",
        "🈳", "㊗️", "㊙️", "🈺", "🈵", "🔴", "🟠", "🟡", "🟢", "🔵", "🟣", "🟤", "⚫", "⚪", "🟥", "🟧", "🟨", "🟩", "🟦", "🟪", "🟫", "⬛",
        "⬜", "◼️", "◻️", "◾", "◽", "▪️", "▫️", "🔶", "🔷", "🔸", "🔹", "🔺", "🔻", "💠", "🔘", "🔳", "🔲"
      ]
    };

    // ---------- Build Tabs & Panels -----------
    function buildTabs(){
      tabTrig.innerHTML="";
      tabPanels.innerHTML="";
      let first=true;
      for(const [label,list] of Object.entries(categories)){
        // trigger button
        const trig=document.createElement("button");
        trig.textContent=label;
        trig.className="px-3 py-1 rounded-t-lg text-sm";
        trig.dataset.tab=label;
        trig.onclick=()=>activate(label);
        tabTrig.appendChild(trig);

        // panel grid
        const panel=document.createElement("div");
        panel.dataset.tab=label;
        panel.className="hidden grid grid-cols-10 gap-2 p-2";
        list.forEach(e=>{
          const btn=document.createElement("button");
          btn.textContent=e;
          btn.className="text-2xl hover:scale-110 transition-transform";
          btn.onclick=()=>{emojiInp.value=e; closeModal();};
          panel.appendChild(btn);
        });
        tabPanels.appendChild(panel);
        if(first){ activate(label); first=false; }
      }
      if(!first){ /* at least one tab built */ }
      else{ tabPanels.innerHTML = '<p class="p-4 text-center text-sm text-gray-500">No categories loaded yet.</p>'; }
    }

    function activate(label){
      [...tabTrig.children].forEach(b=>{
        const act=b.dataset.tab===label;
        b.className=act?"px-3 py-1 rounded-t-lg text-sm bg-indigo-600 text-white":"px-3 py-1 rounded-t-lg text-sm hover:bg-gray-100";
      });
      [...tabPanels.children].forEach(p=>p.classList.toggle("hidden",p.dataset.tab!==label));
    }

    // ---------- Modal helpers ---------------
    function openModal(){ modal.classList.remove("hidden"); }
    function closeModal(){ modal.classList.add("hidden"); }
    btnPicker.onclick=openModal;
    closeBtn.onclick=closeModal;
    modal.onclick=e=>{ if(e.target===modal) closeModal(); };

    // ---------- Random emoji (library) ------
    btnRand.onclick=()=>{ if(window.exports.EmojiSteg){ emojiInp.value=new window.exports.EmojiSteg().getRandomEmoji(); } };

    // ---------- Password toggles ------------
    const toggleVis=input=>{ input.type=input.type==="password"?"text":"password"; };
    togglePwd.onclick=()=>toggleVis(pwd);
    togglePwd2.onclick=()=>toggleVis(pwd2);

    // ---------- Encrypt / Decrypt -----------
    btnEncrypt.onclick=()=>{
      const res=enc(plain.value,pwd.value,emojiInp.value.trim()||undefined);
      cipherInp.value=cipherIn.value=res;
      if(!emojiInp.value.trim()) emojiInp.value=res;
    };
    btnCopy.onclick=()=>{ if(cipherInp.value) navigator.clipboard.writeText(cipherInp.value); };
    btnDecrypt.onclick=()=>{
      try{ decoded.textContent=dec(cipherIn.value.trim(),pwd2.value); decoded.classList.remove("text-red-600"); }
      catch{ decoded.textContent="❌ Wrong password or no data found"; decoded.classList.add("text-red-600"); }
    };

    // Initial tab build (empty)
    buildTabs();

    // Expose for manual fill via console if desired
    window.emojiCategories = categories;
    window.refreshEmojiTabs = buildTabs;
  })();
</script>
</body>
</html>
